# RDR Web 使用指南

## 简介

RDR (Redis Data Reveal) 现已支持 Web 端文件上传和实时分析功能!用户可以通过浏览器直接拖拽或选择 RDB 文件进行在线分析,无需命令行操作。

## 新功能特性

### 1. Web 文件上传界面
- 🎨 现代化、美观的用户界面
- 📁 支持拖拽上传 RDB 文件
- 📂 支持点击选择文件
- 📊 实时显示上传进度
- ✅ 支持多文件上传

### 2. 实时分析功能
- ⚡ 上传后自动开始解析
- 📈 实时展示解析进度
- 🔄 自动跳转到分析结果页面

### 3. 多样化数据可视化
- 📊 饼图展示 Key 类型分布
- 💾 内存使用分析
- 📏 长度级别统计
- 🔝 Top 100 最大 Keys
- 🔍 Key 前缀分析
- 📋 详细数据表格

## 使用方法

### 启动 Web 服务器

```bash
# 使用默认端口 8080
./rdr.exe web

# 或指定自定义端口
./rdr.exe web -p 8081
```

### 访问 Web 界面

启动服务器后,在浏览器中访问:
```
http://localhost:8080
```

### 上传 RDB 文件

1. **拖拽上传**
   - 直接将 .rdb 文件拖拽到上传区域

2. **点击上传**
   - 点击上传区域
   - 在文件选择对话框中选择 .rdb 文件
   - 可以同时选择多个文件

3. **开始分析**
   - 上传完成后,点击"开始分析"按钮
   - 系统会自动解析文件并跳转到结果页面

### 查看分析结果

分析页面包含以下内容:

#### 1. 概览信息卡片
- 总 Key 数量
- 总内存使用
- 数据类型数量
- RDB 文件名

#### 2. 类型分布图表
- Key 数量按类型分布(饼图)
- 内存使用按类型分布(饼图)

#### 3. 长度级别统计
- 不同数据类型的长度分布
- 内存使用分布

#### 4. 最大 Keys 列表
- Top 100 占用内存最大的 Keys
- 包含 Key 名称、类型、内存大小、元素数量
- 支持排序

#### 5. Key 前缀分析
- 按数据类型分组
- 显示每个前缀的内存使用和 Key 数量
- 内存占比可视化进度条

## API 接口

### 上传文件
```
POST /api/upload
Content-Type: multipart/form-data

参数: files (支持多文件)
```

### 获取实例列表
```
GET /list

返回: JSON 格式的实例列表
```

### 查看分析结果
```
GET /instance/:filename

参数: filename - RDB 文件名
```

## 命令对比

### 传统命令行方式
```bash
# 需要指定文件路径
./rdr.exe show /path/to/file.rdb

# 一次只能分析指定的文件
```

### 新 Web 方式
```bash
# 启动一次服务器
./rdr.exe web -p 8080

# 然后可以通过浏览器上传任意数量的 RDB 文件
# 无需重启服务器
```

## 技术架构

### 前端
- 原生 HTML5 + JavaScript
- Bootstrap 3 (响应式布局)
- Chart.js (数据可视化)
- 拖拽上传 API

### 后端
- Go 语言 + httprouter
- 文件上传处理
- RDB 解析引擎
- RESTful API

### 存储
- 上传的文件保存在 `uploads/` 目录
- 解析结果缓存在内存中

## 注意事项

1. **文件大小限制**: 默认最大支持 10GB 的 RDB 文件
2. **并发上传**: 支持同时上传多个文件,但建议单个文件上传完成后再上传下一个
3. **内存使用**: 大文件解析会占用较多内存,请确保服务器有足够的内存
4. **文件保留**: 上传的文件会保存在 `uploads/` 目录中,不会自动删除
5. **浏览器兼容**: 建议使用现代浏览器 (Chrome, Firefox, Edge, Safari)

## 示例

### 1. 快速开始
```bash
# 编译项目
go build -o rdr.exe

# 启动 Web 服务器
./rdr.exe web -p 8080

# 在浏览器中打开 http://localhost:8080
# 拖拽你的 .rdb 文件到页面中
# 点击"开始分析"按钮
```

### 2. 多文件分析
```bash
# 启动服务器后,可以连续上传多个 RDB 文件
# 每个文件都会被单独解析和展示
# 通过侧边栏可以在不同实例间切换
```

## 故障排查

### 上传失败
- 检查文件是否为有效的 .rdb 格式
- 确认文件大小是否超过限制
- 检查 uploads 目录权限

### 页面加载缓慢
- 大文件需要较长解析时间,请耐心等待
- 检查服务器内存使用情况

### 端口被占用
```bash
# 使用其他端口
./rdr.exe web -p 8081
```

## 版本信息

- 当前版本: v0.0.1
- 新增功能: Web 上传和可视化
- 基于原 RDR 项目扩展

## 许可证

Apache License 2.0

---

享受 RDR 的 Web 分析功能! 🚀
